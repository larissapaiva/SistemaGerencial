generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String   @id @default(uuid())
  name          String
  email         String   @unique
  password_hash String
  created_at    DateTime @default(now())

  @@map("users")
}

model Client {
  id           String     @id @default(uuid())
  personType   PersonType @default(CORPORATE)
  document     String?    @unique
  name         String?
  businessName String?
  address      String?
  email        String?
  created_at   DateTime   @default(now())
  invoice      Invoice[]

  @@map("clients")
}

model Invoice {
  id                String      @id @default(uuid())
  issueDate         DateTime
  dueDate           DateTime
  amount            Decimal
  paymentType       PaymentType
  installmentNumber Int?
  invoiceNumber     String
  referenceMonth    Int
  paidOff           Boolean

  client   Client @relation(fields: [clientId], references: [id])
  clientId String

  service     Service       @relation(fields: [serviceId], references: [id])
  serviceId   String
  installment installment[]

  @@map("invoices")
}

model Service {
  id          String    @id @default(uuid())
  description String
  created_at  DateTime  @default(now())
  invoice     Invoice[]

  @@map("services")
}

model installment {
  id                String   @id @default(uuid())
  installmentNumber Int
  amount            Decimal
  dueDate           DateTime
  paidoff           Boolean

  invoice   Invoice @relation(fields: [invoiceId], references: [id])
  invoiceId String
}

enum PersonType {
  INDIVIDUAL
  CORPORATE
  OFFSHORE
}

enum PaymentType {
  CASH
  INSTALLMENT
}
